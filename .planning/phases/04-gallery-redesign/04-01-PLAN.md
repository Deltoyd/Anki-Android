---
phase: 04-gallery-redesign
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - AnkiDroid/src/main/res/layout/activity_museum.xml
  - AnkiDroid/src/main/java/com/ichi2/anki/MuseumActivity.kt
  - AnkiDroid/src/main/java/com/ichi2/anki/ui/museum/HeatmapView.kt
  - AnkiDroid/src/main/res/values/02-strings.xml
autonomous: true

must_haves:
  truths:
    - "Heatmap is no longer visible on the homescreen"
    - "Deck stats row (streak + today's cards) is no longer visible on the homescreen"
    - "Painting area occupies the full lower homescreen with visible padding and rounded corners"
    - "Title and artist name are displayed below the painting"
    - "Existing deck selector, app title, menu button, review button, and gallery pager remain functional"
  artifacts:
    - path: "AnkiDroid/src/main/res/layout/activity_museum.xml"
      provides: "Homescreen layout without heatmap or stats row, expanded painting area"
      contains: "galleryPager"
    - path: "AnkiDroid/src/main/java/com/ichi2/anki/MuseumActivity.kt"
      provides: "Activity without heatmap setup or stats methods"
  key_links:
    - from: "AnkiDroid/src/main/res/layout/activity_museum.xml"
      to: "AnkiDroid/src/main/java/com/ichi2/anki/MuseumActivity.kt"
      via: "View binding references"
      pattern: "binding\\.(galleryPager|captionText|pageIndicator)"
---

<objective>
Remove the heatmap and deck stats from the homescreen, expand the masterpiece painting area to fill the freed space, and add title/artist labels below the painting.

Purpose: The masterpiece should dominate the homescreen. The heatmap will be relocated to a streak bottom sheet in a later phase. Deck stats are removed per user decision -- users access them through other screens.

Output: Updated layout XML and Activity with heatmap/stats removed, painting expanded, and title/artist caption.
</objective>

<execution_context>
@/Users/rolandharper/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rolandharper/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-gallery-redesign/04-CONTEXT.md

@AnkiDroid/src/main/res/layout/activity_museum.xml
@AnkiDroid/src/main/java/com/ichi2/anki/MuseumActivity.kt
@AnkiDroid/src/main/java/com/ichi2/anki/ui/museum/HeatmapView.kt
@AnkiDroid/src/main/java/com/ichi2/anki/ui/museum/MuseumViewModel.kt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove heatmap and stats from layout and Activity</name>
  <files>
    AnkiDroid/src/main/res/layout/activity_museum.xml
    AnkiDroid/src/main/java/com/ichi2/anki/MuseumActivity.kt
  </files>
  <action>
In `activity_museum.xml`:
1. Delete the entire "Stats Row" LinearLayout (the one containing `streakStat` and `todayStat` TextViews, lines ~78-105 in current layout).
2. Delete the entire "Activity Heatmap Section" LinearLayout (containing `heatmapYear`, `heatmapSubheader`, and `heatmapView`, lines ~158-193 in current layout).
3. Remove `android:paddingBottom="88dp"` from the NestedScrollView — the bottom CTA button has its own margin.

In `MuseumActivity.kt`:
1. Delete the `setupHeatmap()` method entirely (including the `generateMockActivityData()` helper).
2. Delete the `setupStats()` method and the `updateStats()` method.
3. Remove the call to `setupHeatmap()` from `onCreate()`.
4. Remove the call to `setupStats()` from `onCreate()`.
5. Remove the call to `updateStats()` from `onResume()`.
6. Remove the `import com.ichi2.anki.ui.museum.toDateKey` import (only used by heatmap).
7. Remove the `import java.util.Calendar` import (only used by heatmap).
8. Remove the `import java.util.Random` import (only used by mock data).
9. Remove bindings references to `streakStat`, `todayStat`, `heatmapYear`, `heatmapSubheader`, `heatmapView` — these are removed from layout so binding won't generate them.

Do NOT delete `HeatmapView.kt` yet — it may be reused in the streak bottom sheet (Phase 7). Just remove its usage from the homescreen.
  </action>
  <verify>
Run `./gradlew assemblePlayDebug` from the project root. Build must succeed with no unresolved references to removed views. Grep for `heatmapView`, `heatmapYear`, `heatmapSubheader`, `streakStat`, `todayStat` in `MuseumActivity.kt` — should find zero matches. Grep for `setupHeatmap\|setupStats\|updateStats\|generateMockActivityData` in `MuseumActivity.kt` — should find zero matches.
  </verify>
  <done>
Heatmap section and stats row are removed from the homescreen layout. MuseumActivity no longer references any heatmap or stats views. Build compiles successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Expand painting area and add title/artist label</name>
  <files>
    AnkiDroid/src/main/res/layout/activity_museum.xml
    AnkiDroid/src/main/java/com/ichi2/anki/MuseumActivity.kt
    AnkiDroid/src/main/res/values/02-strings.xml
  </files>
  <action>
In `activity_museum.xml`:
1. Change the gallery ConstraintLayout + ViewPager2 to use `layout_weight="1"` so it fills all remaining vertical space after the top nav bar. The parent LinearLayout inside NestedScrollView should have `android:layout_height="match_parent"` and the gallery ConstraintLayout should use `android:layout_height="0dp"` with `android:layout_weight="1"` to grab remaining space.
2. Remove the `app:layout_constraintDimensionRatio="H,5:4"` from the ViewPager2. Instead, make the ViewPager2 fill its parent ConstraintLayout: set `layout_width="match_parent"` and `layout_height="match_parent"` (or constrain all 4 edges with `0dp`).
3. Add horizontal padding (16dp) around the gallery ConstraintLayout for the visible margins per user decision.
4. Rename the existing `captionText` TextView to show both title and artist. Update it to include two lines — first line title (serif, 16sp, bold, museolingo_text color), second line artist (serif, 13sp, normal, museolingo_text_secondary). Alternatively, add a second TextView `artistText` below `captionText`. The simpler approach: change `captionText` to show "Title\nArtist" using a single multi-line TextView, OR add a dedicated `artistText` below. Use two separate TextViews for cleaner styling:
   - `captionText`: title — 16sp, serif, bold, `@color/museolingo_text`, center gravity
   - Add new `artistText` below: 13sp, serif, normal, `@color/museolingo_text_secondary`, center gravity, paddingBottom="16dp"
5. Remove the `android:paddingTop="0dp"` and `android:paddingBottom="24dp"` from captionText — use tighter spacing: paddingTop="4dp", paddingBottom="0dp". The new artistText gets paddingBottom="16dp".

In `MuseumActivity.kt`:
1. In the `onPageSelected` callback, update the caption to show title and set artist text:
   ```
   binding.captionText.text = item.artPiece.title
   binding.artistText.text = item.artPiece.artist ?: ""
   ```
2. In the `setupObservers` uiState collector where caption is set, also set artist:
   ```
   binding.captionText.text = state.galleryItems[currentPos].artPiece.title
   binding.artistText.text = state.galleryItems[currentPos].artPiece.artist ?: ""
   ```

In `02-strings.xml`:
1. Add string resource: `<string name="unknown_artist">Unknown artist</string>` — use this as fallback when artist is null if desired, though empty string is also fine per discretion.

Ensure the NestedScrollView `android:fillViewport="true"` is kept so the content stretches to fill the screen.
  </action>
  <verify>
Run `./gradlew assemblePlayDebug` from the project root — build must succeed. Verify `artistText` ID exists in layout XML. Verify `binding.artistText` is referenced in `MuseumActivity.kt`. The gallery pager should now expand to fill available vertical space after the top nav bar.
  </verify>
  <done>
Painting area fills the majority of the homescreen below the top nav bar. Title and artist name are displayed below the painting in proper typography. Layout compiles and binds correctly.
  </done>
</task>

</tasks>

<verification>
1. Build succeeds: `./gradlew assemblePlayDebug`
2. No references to heatmap views in MuseumActivity: `grep -c "heatmap\|streakStat\|todayStat" AnkiDroid/src/main/java/com/ichi2/anki/MuseumActivity.kt` returns 0
3. Layout contains `artistText` and `captionText` but NOT `heatmapView`, `streakStat`, `todayStat`
4. Gallery pager uses weight-based sizing to fill available space
</verification>

<success_criteria>
- Homescreen shows: top nav bar, expanded painting area, page dots, title + artist, review button
- Homescreen does NOT show: heatmap, stats row, year label, subheader
- Build compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-gallery-redesign/04-01-SUMMARY.md`
</output>
