# Milestone v1.1: Puzzle Shape & Transparency Fix

**Status:** SHIPPED 2026-02-13
**Phases:** 2-3
**Total Plans:** 2

## Overview

Fixed two visual issues from v1.0: unlocked pieces now clip to match their locked PNG shapes (creating a unified jigsaw), and locked pieces become semi-transparent (80% opacity) to show the painting underneath. This completes the core visual puzzle experience.

## Phases

### Phase 2: Shape System Fix

**Goal**: Unlocked pieces use the same jigsaw shape as their locked PNG counterpart
**Depends on**: Phase 1
**Requirements**: SHPE-01, SHPE-02
**Plans**: 1 plan

Plans:
- [x] 02-01: Replace path-based clipping with PNG alpha mask clipping for unlocked pieces

**Details:**
- Replaced bezier-curve path clipping with PorterDuff DST_IN compositing using PNG alpha masks
- Eliminated PuzzlePiecePathGenerator entirely (239 lines removed)
- Updated peek mode to use PNG-based outlines
- User visual verification completed on Pixel 7a
- Commit: 1d69856

**Shipped:** 2026-02-13 (1 plan, 2 files changed, +59/-266 lines)

### Phase 3: Transparent Locked Pieces

**Goal**: Locked pieces show the painting underneath at 80% opacity
**Depends on**: Phase 2
**Requirements**: TRANS-01, TRANS-02
**Plans**: 1 plan

Plans:
- [x] 03-01: Add painting-through-locked-pieces rendering with 80% opacity overlay

**Details:**
- Added saveLayer + DST_IN compositing to drawLockedPiecePng() to render painting underneath
- Gray PNG drawn at alpha 204 (80% opacity) on top
- Painting visible through tabs and body (full piece shape)
- Unlocked piece rendering untouched
- User visual verification completed on Pixel 7a
- Commit: f04d222

**Shipped:** 2026-02-13 (1 plan, 1 file changed, +13 lines)

---

## Milestone Summary

**Key Decisions:**
- Use PorterDuff.Mode.DST_IN with saveLayer for PNG alpha mask compositing (replaced bezier paths)
- Delete PuzzlePiecePathGenerator entirely (no other usages in codebase)
- Reuse alphaMaskPaint for locked piece painting clipping
- pieceBitmapPaint.alpha = 204 for 80% gray overlay on locked pieces

**Issues Resolved:**
- Unlocked pieces had different jigsaw shapes than locked PNG pieces (visual mismatch)
- Locked pieces showed only opaque gray (no painting hint)

**Issues Deferred:**
- Card review-driven unlocking (v1.2)
- Daily midnight reset (v1.2)
- Completion celebration & collection (v1.2)

**Technical Debt Incurred:**
None.

---
_For current project status, see .planning/ROADMAP.md_
